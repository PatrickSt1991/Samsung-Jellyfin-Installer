<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:viewModels="clr-namespace:Jellyfin2Samsung.ViewModels"
		xmlns:fa="clr-namespace:FluentAvalonia.UI.Controls;assembly=FluentAvalonia"
        mc:Ignorable="d"
        x:Class="Jellyfin2Samsung.JellyfinConfigView"
        x:DataType="viewModels:JellyfinConfigViewModel"
        Title="Jellyfin Config"
        Width="600"
        Height="1050"
        Background="#F5F5F5">

	<Window.Styles>
		<StyleInclude Source="avares://Avalonia.Themes.Fluent/FluentTheme.xaml"/>
		<StyleInclude Source="avares://Avalonia.Controls.DataGrid/Themes/Fluent.xaml"/>
		<StyleInclude Source="avares://Jellyfin2Samsung/Styles/Buttons.axaml"/>
		<StyleInclude Source="avares://Jellyfin2Samsung/Styles/TextBlocks.axaml"/>
		<StyleInclude Source="avares://Jellyfin2Samsung/Styles/ComboBoxes.axaml"/>
	</Window.Styles>

	<Border Background="White"
            Padding="16"
            CornerRadius="8"
            Margin="6"
            BorderBrush="#E8E8E8"
            BorderThickness="1">

		<Border.Effect>
			<DropShadowEffect BlurRadius="15" OffsetX="2" OffsetY="2" Color="#00000020" Opacity="0.15"/>
		</Border.Effect>

		<Grid>
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto"/>
				<RowDefinition Height="*"/>
			</Grid.RowDefinitions>

			<!-- Header -->
			<Border Grid.Row="0"
                    Background="#2C3E50"
                    CornerRadius="8"
                    Padding="24,20"
                    Margin="0,0,0,14">
				<TextBlock Text="{Binding LblJellyfinConfig}"
                           Foreground="White"
                           FontSize="18"
                           FontWeight="Medium"
                           HorizontalAlignment="Center"/>
			</Border>

			<!-- Settings Content -->
			<ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
				<StackPanel Spacing="18" Margin="0,0,20,0">

					<!-- Server Settings -->
					<StackPanel Spacing="12">
						<TextBlock Text="{Binding LblServerSettings}"
								   FontSize="16"
								   FontWeight="SemiBold"
								   Foreground="#2C3E50"/>

						<Grid ColumnDefinitions="200,*" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding UpdateMode}" Classes="label" VerticalAlignment="Center"/>
							<ComboBox Grid.Column="1"
									  ItemsSource="{Binding AvailableUpdateModes}"
									  SelectedItem="{Binding SelectedUpdateMode}"
									  Classes="clean"
									  HorizontalAlignment="Stretch"/>
						</Grid>

						<Grid ColumnDefinitions="200,*" ColumnSpacing="12">
							<TextBlock Grid.Column="0"
									   Text="{Binding ServerIP}"
									   Classes="label"
									   VerticalAlignment="Center"/>

							<Grid Grid.Column="1">
								<Grid.ColumnDefinitions>
									<ColumnDefinition Width="Auto" />
									<ColumnDefinition Width="Auto" />
									<ColumnDefinition Width="*" />
									<ColumnDefinition Width="Auto" />
									<ColumnDefinition Width="Auto" />
								</Grid.ColumnDefinitions>

								<ComboBox Grid.Column="0"
										  SelectedItem="{Binding SelectedJellyfinProtocol, Mode=TwoWay}"
										  Classes="clean">
									<x:String>http</x:String>
									<x:String>https</x:String>
								</ComboBox>


								<TextBlock Grid.Column="1"
										   Text="://"
										   VerticalAlignment="Center"/>
								
								<TextBox Grid.Column="2"
										Text="{Binding JellyfinServerIp}"
										Classes="clean"
										HorizontalAlignment="Stretch"/>

								<TextBlock Grid.Column="3"
										   Text=":"
										   VerticalAlignment="Center"/>

								<AutoCompleteBox Grid.Column="4"
										   ItemsSource="{Binding JellyfinPorts}"
										   Text="{Binding SelectedJellyfinPort, Mode=TwoWay}"
										   Classes="clean" />

							</Grid>
						</Grid>

						<Grid ColumnDefinitions="200,*" ColumnSpacing="12">
							<TextBlock Grid.Column="0"
									   Text="{Binding LblBasePath}"
									   Classes="label"
									   VerticalAlignment="Center"/>
							<StackPanel Grid.Column="1" Spacing="4">
								<TextBox Text="{Binding JellyfinBasePath}"
										 Watermark="Paste full URL or path: /xxx/jellyfin"
										 Classes="clean"
										 HorizontalAlignment="Stretch"/>
								<TextBlock Text="{Binding LblBasePathHint}"
										   FontSize="11"
										   Foreground="#7F8C8D"
										   TextWrapping="Wrap"/>
							</StackPanel>
						</Grid>

						<Grid ColumnDefinitions="200,*" ColumnSpacing="12">
							<TextBlock Grid.Column="0"
									   Text="{Binding ServerConnectionStatus}"
									   Classes="label"
									   VerticalAlignment="Center"/>
							<Button Grid.Column="1"
									Classes="secondary"
									Content="{Binding LblTestServer}"
									Command="{Binding TestConnectionCommand}"
									IsEnabled="{Binding ServerIpSet}"
									HorizontalAlignment="Left"/>
						</Grid>

						<Grid ColumnDefinitions="200,*" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding LblJellyfinServerApi}" Classes="label" VerticalAlignment="Center"/>
							<TextBox Grid.Column="1"
									 Text="{Binding JellyfinApiKey}"
									 IsEnabled="{Binding ApiKeyEnabled}"
									 Classes="clean"
									 HorizontalAlignment="Stretch"/>
						</Grid>

						<Grid ColumnDefinitions="200,*" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding LblJellyfinUser}" Classes="label" VerticalAlignment="Center"/>
							<ComboBox Grid.Column="1"
									  ItemsSource="{Binding AvailableJellyfinUsers}"
									  SelectedItem="{Binding SelectedJellyfinUser}"
									  IsEnabled="{Binding ApiKeySet}"
									  Classes="clean"
									  HorizontalAlignment="Stretch">
								<ComboBox.ItemTemplate>
									<DataTemplate>
										<TextBlock Text="{Binding Name}"/>
									</DataTemplate>
								</ComboBox.ItemTemplate>
							</ComboBox>
						</Grid>
						<Grid ColumnDefinitions="200,*" ColumnSpacing="12">
							<TextBlock Grid.Column="0"
									   Text="{Binding LblEnableDevLogs}"
									   Classes="label"
									   VerticalAlignment="Center"/>
							<Grid Grid.Column="1" ColumnDefinitions="*,Auto" ColumnSpacing="12">
								<Button Grid.Column="0"
										Classes="secondary"
										HorizontalAlignment="Stretch"
										Command="{Binding OpenDebugWindowCommand}"
										IsEnabled="{Binding CanOpenDebugWindow}">
									<StackPanel Orientation="Horizontal" Spacing="6">
										<fa:SymbolIcon Symbol="Document" Width="16" Height="16" />
										<TextBlock Text="{Binding lblOpenDebugWindow}" />
									</StackPanel>
								</Button>
								<ToggleSwitch Grid.Column="1"
											  IsChecked="{Binding EnableDevLogs, Mode=TwoWay}"
											  IsEnabled="{Binding ApiKeySet}"/>
							</Grid>
						</Grid>

						<Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
							<TextBlock Grid.Column="0"
									   Text="{Binding LblUseServerScripts}"
									   Classes="label"
									   VerticalAlignment="Center"/>
							<ToggleSwitch Grid.Column="1"
										  IsChecked="{Binding UseServerScripts}"
										  IsEnabled="{Binding ApiKeySet}"/>
						</Grid>
						
						<Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
							<TextBlock Grid.Column="0"
									   Text="{Binding lblFixYouTube153}"
									   Classes="label"
									   VerticalAlignment="Center"/>
							<ToggleSwitch Grid.Column="1"
									IsEnabled="{Binding ApiKeyEnabled}"
									IsChecked="{Binding PatchYoutubePlugin}"/>
						</Grid>
					</StackPanel>

					<Border Height="1" Background="#E8E8E8"/>

					<!-- Auto-Login Settings -->
					<StackPanel Spacing="12">
						<TextBlock Text="{Binding LblAutoLoginSettings}"
								   FontSize="16"
								   FontWeight="SemiBold"
								   Foreground="#2C3E50"/>

						<Grid ColumnDefinitions="200,*" ColumnSpacing="12">
							<TextBlock Grid.Column="0"
									   Text="{Binding LblJellyfinUsername}"
									   Classes="label"
									   VerticalAlignment="Center"/>
							<TextBox Grid.Column="1"
									 Text="{Binding JellyfinUsername}"
									 Watermark="Jellyfin username"
									 Classes="clean"
									 HorizontalAlignment="Stretch"/>
						</Grid>

						<Grid ColumnDefinitions="200,*" ColumnSpacing="12">
							<TextBlock Grid.Column="0"
									   Text="{Binding LblJellyfinPassword}"
									   Classes="label"
									   VerticalAlignment="Center"/>
							<TextBox Grid.Column="1"
									 Text="{Binding JellyfinPassword}"
									 PasswordChar="*"
									 Watermark="Jellyfin password"
									 Classes="clean"
									 HorizontalAlignment="Stretch"/>
						</Grid>

						<Grid ColumnDefinitions="*,Auto,Auto" ColumnSpacing="8">
							<TextBlock Grid.Column="0"
									   Text="{Binding AuthenticationStatus}"
									   Classes="label"
									   VerticalAlignment="Center"/>
							<Button Grid.Column="1"
									Classes="primary"
									Content="{Binding LblAuthenticate}"
									Command="{Binding AuthenticateCommand}"
									IsEnabled="{Binding CanLogin}"/>
							<Button Grid.Column="2"
									Classes="secondary"
									Content="âš™"
									ToolTip.Tip="{Binding LblEnableAutoLoginConfig}"
									Command="{Binding EnableAutoLoginConfigCommand}"
									IsVisible="{Binding IsAuthenticated}"
									Width="36"/>
						</Grid>
					</StackPanel>

					<Border Height="1" Background="#E8E8E8"/>

					<!-- Browser Settings -->
					<StackPanel Spacing="12" IsEnabled="{Binding ApiKeySet}">
						<TextBlock Text="{Binding LblBrowserSettings}"
								   FontSize="16"
								   FontWeight="SemiBold"
								   Foreground="#2C3E50"/>

						<Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding LblEnableBackdrops}" Classes="label" VerticalAlignment="Center"/>
							<ToggleSwitch Grid.Column="1" IsChecked="{Binding EnableBackdrops}"/>
						</Grid>

						<Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding LblEnableThemeSongs}" Classes="label" VerticalAlignment="Center"/>
							<ToggleSwitch Grid.Column="1" IsChecked="{Binding EnableThemeSongs}"/>
						</Grid>

						<Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding LblEnableThemeVideos}" Classes="label" VerticalAlignment="Center"/>
							<ToggleSwitch Grid.Column="1" IsChecked="{Binding EnableThemeVideos}"/>
						</Grid>

						<Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding LblBackdropScreensaver}" Classes="label" VerticalAlignment="Center"/>
							<ToggleSwitch Grid.Column="1" IsChecked="{Binding BackdropScreensaver}"/>
						</Grid>

						<Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding LblDetailsBanner}" Classes="label" VerticalAlignment="Center"/>
							<ToggleSwitch Grid.Column="1" IsChecked="{Binding DetailsBanner}"/>
						</Grid>

						<Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding LblCinemaMode}" Classes="label" VerticalAlignment="Center"/>
							<ToggleSwitch Grid.Column="1" IsChecked="{Binding CinemaMode}"/>
						</Grid>

						<Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding LblNextUpEnabled}" Classes="label" VerticalAlignment="Center"/>
							<ToggleSwitch Grid.Column="1" IsChecked="{Binding NextUpEnabled}"/>
						</Grid>

						<Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding LblEnableExternalVideoPlayers}" Classes="label" VerticalAlignment="Center"/>
							<ToggleSwitch Grid.Column="1" IsChecked="{Binding EnableExternalVideoPlayers}"/>
						</Grid>

						<Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding LblSkipIntros}" Classes="label" VerticalAlignment="Center"/>
							<ToggleSwitch Grid.Column="1" IsChecked="{Binding SkipIntros}"/>
						</Grid>

						<Grid ColumnDefinitions="200,*" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding LblAudioLanguagePreference}" Classes="label" VerticalAlignment="Center"/>
							<TextBox Grid.Column="1" Text="{Binding AudioLanguagePreference}" Classes="clean"/>
						</Grid>

						<Grid ColumnDefinitions="200,*" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding LblSubtitleLanguagePreference}" Classes="label" VerticalAlignment="Center"/>
							<TextBox Grid.Column="1" Text="{Binding SubtitleLanguagePreference}" Classes="clean"/>
						</Grid>

						<Grid ColumnDefinitions="200,*" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding Theme}" Classes="label" VerticalAlignment="Center"/>
							<ComboBox Grid.Column="1"
									  ItemsSource="{Binding AvailableThemes}"
									  SelectedItem="{Binding SelectedTheme}"
									  Classes="clean"/>
						</Grid>

						<Grid ColumnDefinitions="200,*" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding LblSubtitleMode}" Classes="label" VerticalAlignment="Center"/>
							<ComboBox Grid.Column="1"
									  ItemsSource="{Binding AvailableSubtitleModes}"
									  SelectedItem="{Binding SelectedSubtitleMode}"
									  Classes="clean"/>
						</Grid>
					</StackPanel>

					<Border Height="1" Background="#E8E8E8"/>

					<!-- User Settings -->
					<StackPanel Spacing="12" IsEnabled="{Binding ApiKeySet}">
						<TextBlock Text="{Binding LblUserSettings}"
								   FontSize="16"
								   FontWeight="SemiBold"
								   Foreground="#2C3E50"/>

						<!-- Toggle Switches -->
						<Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding LblAutoPlayNextEpisode}" Classes="label" VerticalAlignment="Center"/>
							<ToggleSwitch Grid.Column="1" IsChecked="{Binding AutoPlayNextEpisode}"/>
						</Grid>

						<Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding LblRememberAudioSelections}" Classes="label" VerticalAlignment="Center"/>
							<ToggleSwitch Grid.Column="1" IsChecked="{Binding RememberAudioSelections}"/>
						</Grid>

						<Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding LblRememberSubtitleSelections}" Classes="label" VerticalAlignment="Center"/>
							<ToggleSwitch Grid.Column="1" IsChecked="{Binding RememberSubtitleSelections}"/>
						</Grid>

						<Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding LblPlayDefaultAudioTrack}" Classes="label" VerticalAlignment="Center"/>
							<ToggleSwitch Grid.Column="1" IsChecked="{Binding PlayDefaultAudioTrack}"/>
						</Grid>

						<Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
							<TextBlock Grid.Column="0" Text="{Binding LbluserAutoLogin}" Classes="label" VerticalAlignment="Center"/>
							<ToggleSwitch Grid.Column="1" IsChecked="{Binding UserAutoLogin}"/>
						</Grid>
					</StackPanel>

				</StackPanel>
			</ScrollViewer>
		</Grid>
	</Border>
</Window>